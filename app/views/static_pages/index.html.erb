<%= javascript_tag do %>
  var js_array = [<%= raw @object.to_json %>];
  $(window).keyup(function() {
    $(".match-big").html("");
    $(".match-second").html("");
    var myData = $("#query_content").val();
    $.ajax( {
      url: "http://porkcast.herokuapp.com/tags.json",
      data: { value: myData },
      type: "GET",
      dataType : "json",
      success: function( json ) {
        if($("#query_content").val().length > 2) {
        var myIterator = 1;
          json.forEach(function(tag){
            if(myIterator < 6){
              $(".match-big").append("<div class=" + "'possible-match'" + ">" + tag + "</div>");
              myIterator++;
              console.log(myIterator);
            } else if(myIterator < 12){
              $(".match-second").append("<div class=" + "'possible-match'" + ">" + tag + "</div>");
              myIterator++;
            }
          });
        }
       },
      error: function( xhr, status, errorThrown ) { console.log("error!"); },
      complete: function( xhr, status ) { console.log("complete!"); }
    });
  });
<% end %>

<div class = "upper-fold">
<div class="row">
  <div class="col-md-12"><h1>PorkCasts</h1></div>
</div>
<div class="row">
  <div class="col-md-2">

    <div class="match-big" style="text-align:center; width: 250px;z-index: 1000;position:absolute;margin-left:73px;margin-top:-54px;"></div>
    <div class="match-second" style="text-align:center; width: 250px;z-index: 1100;position:absolute;margin-left:833px;margin-top:-54px;"></div>
  </div>
  <div class="col-md-8 center-stuff">
    <% if current_user %>
      <h2>Welcome to PorkCasts, <%= current_user.email %> !</h2>
      <h4>Not <%= current_user.email %>? <%= link_to "Click here", destroy_user_session_path, :method => :delete %>
    <% end %>

    <%= form_for @user do |f| %>
      <p class="line-one">Enter your email to get your PorkCasts!</p>
      <%= f.text_field :email, :placeholder => "bob@gmail.com" %>
      <br>
      <br>
      <p class="line-two">Get a PorkCast whenever the state writes a check to...</p>
      <%= fields_for @query do |query_fields| %>
        <%= query_fields.text_field :content, :placeholder => "Walmart" %>
      <% end %>
      <br><br>
      <div class="porkcast-click">
        <%= f.submit "PorkCast!" %>
      </div>
    <% end %>

    </div>

  <div class="col-md-2">
  </div>
</div>
</div>

<% if @max_cards[-1] %>
<div class="row">
  <div class="col-md-6">
    <div class="front-page-header"><h4>Top Credit Card Charges</h4></div>
    <div class="front-page">
      <table class="table table-striped table-bordered">
        <thead>
          <th>#</th>
          <th>Payee</th>
          <th>Payment</th>
          <th>Date</th>
        </thead>
        <tbody>
          <% i = 1 %>
          <% while i < 11 %>
            <tr class="pork-row">
              <td><%= i %></td>
              <td><%= @max_cards[-i]["merchant"]%></td>
              <td><%= "$" + number_with_precision(@max_cards[-i]["amount"].to_i, :precision => 2, :delimiter => ',').to_s %></td>
              <td><%= @max_cards[-i]["billing_date"].to_date.strftime("%m/%d/%Y") %></td>
              <% i += 1 %>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
  <% end %>
  <% if @max_checks[-1] %>
  <div class="col-md-6">
   <div class="front-page-header"> <h4>Top Checks</h4></div>
    <div class="front-page">
      <table class="table table-striped table-bordered">
        <thead>
          <th>#</th>
          <th>Payee</th>
          <th>Payment</th>
          <th>Date</th>
        </thead>
        <tbody>
          <% i = 1 %>
          <% while i < 11 %>
            <tr class="pork-row">
              <td><%= i %></td>
              <td><%= @max_checks[-i]["payee"]%></td>
              <td><%= "$" + number_with_precision(@max_checks[-i]["amount"].to_i, :precision => 2, :delimiter => ',').to_s %></td>
              <td><%= @max_checks[-i]["payment_date"].to_date.strftime("%m/%d/%Y") %></td>
              <% i += 1 %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <% end %>
  </div>
</div>
